---
title: "World Health Organization (WHO) Cholesterol Data vs. Death Rates"
author: "Steve Bargelt"
date: "May 5, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Getting Started

### Load packages

Package loading:
```{r load-packages, message=FALSE}
library(WHO)
library(plyr)
library(dplyr)
library(ggplot2)
```

### Data

Our investigation will focus on World Health Organization data on cholesterol data and correlation to non-communicable diseases as casue of death. 

Load the data file... you can find a description of my file preparation and ALL source code at [Github](https://github.com/stevebargelt/WHO-Data "WHO Cholesterol Data")

```{r load-data}

load(file="choDeathData.RData")

```

## Age Standardized vs. Crude Cholesterol Numbers
```{r removingOneCHOnumber}
mean(choDeathData$choAgeStandValue, na.rm = TRUE)
mean(choDeathData$choCrudeValue, na.rm = TRUE)
median(choDeathData$choAgeStandValue, na.rm = TRUE)
median(choDeathData$choCrudeValue, na.rm = TRUE)
IQR(choDeathData$choAgeStandValue, na.rm = TRUE)
IQR(choDeathData$choCrudeValue, na.rm = TRUE)

nrow(choDeathData[complete.cases(choDeathData[,c(7,8)]),])
nrow(choDeathData[complete.cases(choDeathData[,c(7,9)]),])
```

Must decide on one or the other since not all values are present for all data points. Decided to use Age Standardized value since there are ~20 more compelte cases.

```{r remove choAgeStanValue}
#choDeathData$choAgeStandValue <- NULL
choDeathData <- choDeathData[complete.cases(choDeathData[,c(7,9)]),]

```

## Including Plots

You can also embed plots, for example:

```{r maleCHOCrude, echo=FALSE}

r2<-ddply(choDeathData,.(sex),function(x) summary(lm(x$totalCVDvalue ~ x$choAgeStandValue))$r.squared)
names(r2)<-c("sex","r2")

r<-ddply(choDeathData,.(sex),function(x) cor(x$totalCVDvalue, x$choAgeStandValue, , method="pearson"))
names(r)<-c("sex","r")


g<-ggplot(choDeathData, aes(x=choAgeStandValue,y=totalCVDvalue,group=sex))
g<-g+geom_point(aes(color=sex))
g<-g+geom_smooth(method="lm",aes(color=sex))
g<-g+geom_text(data=r2,aes(color=sex, label = paste("R^2: ", r2,sep="")),parse=T,x=5.5,y=c(800,750), show.legend=TRUE)
g<-g+geom_text(data=r,aes(color=sex, label = paste("R: ", r,sep="")),parse=T,x=5.5,y=c(700,650), show.legend=TRUE)
g<-g+theme_light(9)
g+labs(x = "Age standardized cholesterol Mean mmol/L\n", y = "CVD Death rate per 100,000", 
       linetype = NULL, color = NULL,
       title = "Cardiovascualr Death Rate vs. Mean Cholesteral (Age Standardized) (by region)\n")

choDeathData %>% 
  filter(sex == "Male") %>% 
  ggplot(aes(x=choCrudeValue, y=totalCVDvalue)) +
  geom_point(shape=1) +    # Use hollow circles
  geom_smooth(method = lm) +
  theme_light(9) +
  labs(x = "Cholesterol Mean mmol/L\n", y = "Male CVD Death rate per 100,000", 
       linetype = NULL, color = NULL,
       title = "Cardiovascualr Death Rate vs. Mean Cholesteral (crude) (by region)\n")

```

```{r femaleCHOCrude, echo=FALSE}
choDeathData %>% 
  filter(sex == "Female") %>% 
  ggplot(aes(x=choCrudeValue, y=totalCVDvalue)) +
  geom_point(shape=1) +    # Use hollow circles
  geom_smooth(method = lm) +
  theme_light(9) +
  labs(x = "Cholesterol Mean mmol/L\n", y = "Female CVD Death rate per 100,000", 
       linetype = NULL, color = NULL,
       title = "Cardiovascualr Death Rate vs. Mean Cholesteral (crude) (by region)\n")

```

```{r maleCHOAgeStand, echo=FALSE}
choDeathData %>% 
  filter(sex == "Male") %>% 
  ggplot(aes(x=choAgeStandValue, y=totalCVDvalue)) +
  geom_point(shape=1) +    # Use hollow circles
  geom_smooth(method = lm) +
  theme_light(9) +
  labs(x = "Cholesterol Mean mmol/L\n", y = "Male CVD Death rate per 100,000", 
       linetype = NULL, color = NULL,
       title = "Cardiovascualr Death Rate vs. Mean Cholesteral (Age Standardized) (by region)\n")

```

```{r femaleCHOAgeStand, echo=FALSE}
choDeathData %>% 
  filter(sex == "Female") %>% 
  ggplot(aes(x=choAgeStandValue, y=totalCVDvalue)) +
  geom_point(shape=1) +    # Use hollow circles
  geom_smooth(method = lm) +
  theme_light(9) +
  labs(x = "Cholesterol Mean mmol/L\n", y = "Female CVD Death rate per 100,000", 
       linetype = NULL, color = NULL,
       title = "Cardiovascualr Death Rate vs. Mean Cholesteral (Age Standardized) (by region)\n")

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
